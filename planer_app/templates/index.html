{% extends "base.html" %}

{% block title %}☑️ Your tasks{% endblock title %}

{% block content %}

<body>

  <div class="tasksWrapper">
    <div id="tasks" class="tasks">
      {% for user in users %}
        <div class="tasksContentWrapper">
          <div class="tasksContent">
            <h3>{{user}}</h3>
            <ul>
              {% for task in tasks %}
              {% if user == task.locator_id.username %}
              <li class="listItem">
                  <label>{{task.task_id.name}}</label>
                  <form name="{{task.task_id.id}}" method="post">
                    {% csrf_token %}
                    <input type="hidden" name={{task.task_id.id}} value = "0">
                    {% if task.is_done %}
                      <input type="checkbox" name="{{task.task_id.id}}" checked>
                    {% else %}
                      <input type="checkbox" name="{{task.task_id.id}}">
                    {% endif %}
                  </form>
              </li>
              {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>

  <script>

    document.addEventListener('DOMContentLoaded', function() {

      var checkboxes = document.querySelectorAll('input[type="checkbox"]');

      console.log(checkboxes);

      for (checkbox of checkboxes) {
        checkbox.addEventListener('change', function() {
          var forms = document.forms;
          for (var i = 0; i < forms.length; i++) {
            if (forms[i].name === checkbox.name) {
                forms[i].submit();
            }
        }
      });
      }
    });

  </script>


</body>
{% endblock content %}

